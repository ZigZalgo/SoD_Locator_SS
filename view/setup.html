<!DOCTYPE html>

<html>

<head>
<title>Super Cool SOD Visualizer</title>
    <script type="text/javascript">
        <!--
        if (screen.width <= 699) {
            document.location = "/mobile";
        }
        //-->
    </script>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />


    <script src="/dataJS"></script>
    <script src="/kinetic"> </script>

<script src = "/jquery"> </script>
<script src="/socket.io/socket.io.js"></script>
<link href="/style" rel="stylesheet"  />
    <script src="/overviewJS"></script>
    <script src="/calibrateJS"></script>



    <script>
    $(document).ready(function(){
        $("#calibration_flip").click(function(){
            $("section#canvas").hide();
            $("section#overview").hide();
            $('#dataManage').hide();
            $("#calibration_section").fadeIn("fast");
            refreshSensors();
            $('.status').html('<span class="normal_status">Calibrate Mode!</span>');
            $('.normal_status').fadeIn(600);
        });
        $('#overview_flip').on('click',function(){
            $("#calibration_section").hide();
            $('#dataManage').hide();
            $("section#canvas").fadeIn("fast");
            $("section#overview").fadeIn("fast");
            $('.status').html('<span class="normal_status">OverView</span>');
            $('.normal_status').fadeIn(600);
        });
        $('#dataManage_flip').on('click',function(){
            console.log('data flip!');
            $("section#canvas").hide();
            $("section#overview").hide();
            $("#calibration_section").hide();
            $('#dataManage').fadeIn("fast");
            showNormalStatus('Data Manage Mod');
        })
        $('#refreshSensors').on('click',function(){
            refreshSensors();
        })


        $('#sampleClients_flip').on('mouseover',function(){
            $('#sampleClients_list').fadeIn('100');
        });
        $('#sampleClients_flip').on('mouseleave',function(){
            $('#sampleClients_list').fadeOut('100');
        });


        // clear the points for sensor one
        $('#clear_master_points').click(function(){
            $('input[name=master_point1X]').val('');
            $('input[name=master_point1Y]').val('');
            $('input[name=master_point2X]').val('');
            $('input[name=master_point2Y]').val('');
            sensorOnePoints.splice(0,sensorOnePoints.length); // clear all the points for sensor one
            $('.status').html("<span class='green_status'>Reference Sensor Points Cleared!</span>");
            $('.green_status').fadeIn(600);
        });

        // clear the points for sensor one
        $('#clear_sensorTwo_points').click(function(){
            $('input[name=sensor_point1X]').val('');
            $('input[name=sensor_point1Y]').val('');
            $('input[name=sensor_point2X]').val('');
            $('input[name=sensor_point2Y]').val('');
            sensorTwoPoints.splice(0,sensorTwoPoints.length); // clear all the points for sensor one
            showGreenStatus("Sensor Two Points Cleared!");
        });

        $('body').on('click','.get_unpaired_people',function(){
        var deviceID = uniqueDeviceIDToSocketID[$("td:first",$(this).parents('tr')).text()];
            console.log("Selected Device: " + deviceID + "\tuniquePersonID: "+ $(this).text());
            io.emit("pairDeviceWithPerson",{deviceSocketID:deviceID, uniquePersonID: $(this).text()},function(callback){
                console.log(JSON.stringify(callback));
            });
        })

        $('#dumpData_BTN').on('click',function(){
            console.log('asking: ' + Number($('#dumpDataPersonID').val()) + ' to dump data in range '+ Number($('#dumpDataRange').val()));
            io.emit('dropData',{ID:Number($('#dumpDataPersonID').val()), range:Number($('#dumpDataRange').val())},function(data){
                console.log(data);
                showGreenStatus(data);
            });
        })


    });
</script>
</head>
<body onload="drawGrid(); refreshSensors();fileList();">
<div id="page-wrap">
    <section id="top">
        <header>Super Cool SOD Visualizer
            </header>
        <nav id="mode_selection" >
            <ul>
                <li id="overview_flip">Overview</li>
                <li id="calibration_flip">Calibration Mode</li>
                <li id="dataManage_flip">Data Management</li>
                <li id="sampleClients_flip">Sample Clients
                <ul id="sampleClients_list" style="display:none;">
                    <li><a href="/JSDeviceClient" target="_blank">Device Client</a></li>
                    <li><a href="/JSSensorClient" target="_blank">Sensor Client</a></li>
                    <li><a href="/JSDataPointClient" target="_blank">DataPoints Client</a></li>
                </ul>
                </li>
            </ul>
        </nav>
        <section id="calibration_section">
            <div class="button" id = "refreshSensors">Refresh Sensors</div>
            <div id = "getCalibrationFrames"> Get Image!</div>
            <!--<input id="getCalibrationFrames" type="button" value="Get Calibration Frames"> <!-- Get Image button -->
            <form>
                <table>
                    <tr>
                        <td>
                            <fieldset class="master">
                                <legend>References Sensor</legend>
                                <div class="calibration_wrap">
                                    <h5>Please Select a reference sensor:</h5>
                                    <select id="referenceSensorList"  name="referenceSensorList"></select>
                                    <div class="canvas_wrap"><canvas id="cnvSensorOne" width="640" height="480"
                                                                     style="z-index: 4;"></canvas> </div>
                                    <!--This is where the data from the server is added-->
                                </div>
                                <fieldset class="sub_field">
                                    <legend>Points Selected</legend>
                                    <!--<div class="pointsStatus" id="sensorOneStatus"></div>-->
                                    <div class="points">
                                        Master Point1    X:<input type="text" name="master_point1X" value="">
                                        Y:<input type="text" name="master_point1Y" value=""></br>
                                    </div>
                                    <div class="points">
                                        Master Point2 X:<input type="text" name="master_point2X" value="">
                                        Y:<input type="text" name="master_point2Y" value=""></br>
                                    </div>
                                    <div class="button" id="clear_master_points"> Clear Points </div>
                                </fieldset>
                            </fieldset>
                        </td>
                        <td>
                            <fieldset class="master">
                                <legend>Sensors Being Calibrated</legend>
                                <div class="calibration_wrap">
                                    <h5>Please Select a Sensor:</h5>
                                    <select id="uncalibratedSensorList" name="uncalibratedSensorList"></select>
                                    <div class="canvas_wrap"><canvas id="cnvSensorTwo" width="640" height="480"
                                                                     style="z-index: 4;"></canvas>
                                    </div>
                                    <!--This is where the data from the server is added-->

                                    <fieldset class="sub_field">
                                        <legend>Points Selected</legend>
                                        <!--<div class="pointsStatus" id="sensorTwoStatus" ></div> <!--This is where the data from the server is added-->
                                        <div class="points">
                                            Sensor Point1   X:<input type="text" name="sensor_point1X" value="">
                                            Y:<input type="text" name="sensor_point1Y" value=""></br>
                                        </div> 
                                        <div class="points">
                                            Sensor Point2 X:<input type="text" name="sensor_point2X" value="">
                                            Y:<input type="text" name="sensor_point2Y" value=""></br>
                                        </div>
                                        <div class="button" id="clear_sensorTwo_points"> Clear Points </div>
                                    </fieldset>
                                </div>
                            </fieldset>
                        </td>
                    </tr>
                </table>
            </form>

            <!--<input id="calibrate" type="button" value="Calibrate!">-->

            <div class="button" id="calibrate"> Calibrate! </div>
            <div id="calibration_bottom"> </div>
        </section>

    </section>
    <section id="canvas">
        <div id="cnvStationary"></div>
        <canvas id="cnv" width="800" height="800" ></canvas>
        <canvas id="cnvSensors" width="800" height="800"></canvas>
        <canvas id="cnvBG" width="800" height="800"></canvas>
    </section>
    <section id="overview">

        <form>
            <!--<input type="text" id="message" /> <!--text form to send data to the server-->
            <div id="contentHeader" >Overview</div> <!--This is where the data from the server is added-->

            <fieldset id="clients">
                <legend> Clients </legend>
            </fieldset>  <!--This is where the data from the server is added-->
            <fieldset id="sensors" >
                <legend> Sensors </legend>
            </fieldset> <!--This is where the data from the server is added-->
            <fieldset id="people">
                <legend> People </legend>
            </fieldset> <!--This is where the data from the server is added-->
            <fieldset id="devices">
                <legend> Devices </legend>
            </fieldset> <!--This is where the data from the server is added-->

            <fieldset id="dataPoints">
                <legend> dataPoints </legend>
            </fieldset> <!--This is where the data from the server is added-->


        </form>
    </section>
    <section id="dataManage">
        <div id="dataManage_wrap">
            <h1>Files List: </h1>
            <select id="filesList" size="15"></select>
            </br>
            <div>
                <section id="upload">
                    <form method="post" enctype="multipart/form-data" action="/upload">
                        <input type="file" name="dataFile" style="color: whitesmoke;">
                        <input type="submit">
                    </form>
                </section>
            </div>
        </div> <!-- End of dataManage_wrap -->
    </section>


    <div class="status_wrap">
        <h1>status:</h1>
        <div class="status"></div> <!--This is where the data from the server is added-->
    </div>



</div><!-- closing page wrap -->
</body>
</html>