<!DOCTYPE html>

<html>
<link href="/JSclientCSS" rel="stylesheet"  />

<head>
    <title>SOD Client</title>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="/SoDLibrary"></script>

    <script>
        var device = {  ID : null,
            name : 'JSClient',
            socketID : null,
            deviceType : "JSClientDevice",
            location : {X: 0, Y: 0, Z:0},
            orientation : null,
            FOV : 0,
            height : 0,
            width :  0,
            ownerID : null,
            pairingState : "unpaired",
            intersectionPoint : {X: 0, Y: 0},
            lastUpdated : new Date(),
            stationary : false,
            deviceIP : ''
        }

        function showRedStatus(status){
            $('.status').html("<span class='red_status'>"+status+"</span>");
            $('.red_status').fadeIn(600);
        }

        function showGreenStatus(status){
            $('.status').html("<span class='green_status'>"+status+"</span>");
            $('.green_status').fadeIn(600);
        }

        function showNormalStatus(status){
            $('.status').html("<span class='normal_status'>"+status+"</span>");
            $('.normal_status').fadeIn(600);
        }

        $(document).ready(function(){
            var port = $('input#serverPort').val();
            var serverIP = $('input#serverIP').val();
            var serverURL = "http://"+serverIP+":"+port;
            var socketURL = serverURL+"/socket.io/socket.io.js";
            var libraryURL= serverURL+"/SOD_JS_Library"

            //initialization:
            var sod = new SOD(device);
            sod.init(serverURL,socketURL, sod);

            //ADD LISTENERS////////////////////////////////////////////////
            sod.addListener('connect',function(data){
                sod.registerDevice();
            });

            sod.addListener('request',function(data){
                console.log(JSON.stringify('Requested requestName: '+ JSON.stringify(data)));
            });

            sod.addListener('string', function(data){
                console.log("Received: " + JSON.stringify(data))
            })

            //END LISTENERS////////////////////////////////////////////////

            //default callback function
            var testFunction = function(data){
                if(data.status!=undefined){
                    showGreenStatus(data.status);
                }
                else{
                    console.log("status: "+JSON.stringify(data));
                };
            }

            $("#connect").on('click',function(){
                sod.initialize(serverURL,socketURL);
            }) // end of click

            $("#setSocket").on('click',function(){
                console.log("Don't need this anymore, remove button?")
            }) // end of click

            $("#reconnect").on('click',function(){
                sod.reconnect(testFunction);
            }) // end of click

            $("#getDevicesAll").on('click',function(){

                sod.getDeviceWithSelection('all',testFunction);
            }) // end of click

            $("#getDevicesInView").on('click',function(){
                sod.getDeviceWithSelection('inView',testFunction);
            }) // end of click

            $("#getPeopleAll").on('click',function(){
                sod.getAllPeople(testFunction);
            }) // end of click

            $("#unpairDevice").on('click',function(){
                sod.unpairDevice(testFunction);
            }) // end of click

            $("#unpairAllPeople").on('click',function(){
                sod.unpairAllPeople(testFunction);
            }) // end of click

            $("#unpairAllDeivces").on('click',function(){
                sod.requestDataFromSelection(testFunction);
            }) // end of click

            $("#requestToAll").on('click',function(){
                var selection = 'all';
                var data = $('#requestData').val();
                sod.requestDataFromSelection(selection,data);
            }) // end of click
            $("#requestByID").on('click',function(){
                var selection = 'single';
                var ID = Number($('#requestID').val());
                var data = $('#requestDataByID').val();
                console.log('requesting '+ID+'withName' +data);
                sod.requestDataFromSelection(selection,data,ID);
            }) // end of click

        })// end of document ready
    </script>
</head>
<body onload="">
<div id="page-wrap">
    <section id="top">
        <header>SOD Client
        </header>
    </section>

    <nav id="mode_selection" >
        <div class="block"></div>
            <table>
                <tr><td><li id="connect">Connect&Register</li> </td><td>IP: <input id='serverIP'  type="text" value='localhost'> Port:<input id='serverPort'  type="text" value='3000'></td></tr>
                <tr><td><li id="setSocket">Set Socket</li></td></tr>
                <tr><td><li id="reconnect">Reconnect</li></td></tr>
                <tr><td><li id="getPeopleAll">Get All People</li></td></tr>
                <tr><td><li id="getDevicesAll">Get Devices(All)</li></td></tr>
                <tr><td><li id="getDevicesInView">Get Devices(inView)</li></td></tr>
                <tr><td><li id="unpairDevice">Unpair Device</li></td></tr>
                <tr><td><li id="unpairAllDeivces">Unpair All Device</li></td></tr>
                <tr><td><li id="unpairAllPeople">Unpair All People</li></td></tr>
                <tr><td><li id="requestToAll">Request(All)</li> </td><td>Request data<input id='requestData'  type="text" value='Brazil request something!! '></td></tr>
                <tr><td><li id="reply">Reply</li> </td><td>Reply Data<input id='replyData'  type="text" value='Brazil reply something!!'></td></tr>
                <tr><td><li id="requestByID">Request(ID)</li> </td><td>Request data<input id='requestDataByID'  type="text" value='Brazil request something!! with ID'> <br/>
                    ID<input id='requestID'  type="text" value='0'></td></tr>
            </table>
        </nav>
    <div class="status_wrap">
        <h1>status:</h1>
        <div class="status"></div> <!--This is where the data from the server is added-->
    </div>

</div><!-- closing page wrap -->
</body>
</html>